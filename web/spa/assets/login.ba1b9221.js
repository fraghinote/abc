import{c as w,r as y,X as A,I as E,J as I,e as Q,h as k,d as P,g as j,D as F,n as z,as as D,at as N,a1 as O,a3 as U,ak as J,a6 as m,a5 as K,aj as R,a9 as M,a7 as _}from"./index.216ed44c.js";import{u as T}from"./use-quasar.2a4044c0.js";var X=w({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validation-success","validation-error"],setup(a,{slots:r,emit:l}){const o=j(),f=y(null);let u=0;const t=[];function b(e){const s=[],p=typeof e=="boolean"?e:a.noErrorFocus!==!0,C=++u,g=(i,n)=>{l("validation-"+(i===!0?"success":"error"),n)};for(let i=0;i<t.length;i++){const n=t[i],d=n.validate();if(typeof d.then=="function")s.push(d.then(c=>({valid:c,comp:n}),c=>({valid:!1,comp:n,err:c})));else if(d!==!0){if(a.greedy===!1)return g(!1,n),p===!0&&typeof n.focus=="function"&&n.focus(),Promise.resolve(!1);s.push({valid:!1,comp:n})}}return s.length===0?(g(!0),Promise.resolve(!0)):Promise.all(s).then(i=>{const n=i.filter(q=>q.valid!==!0);if(n.length===0)return C===u&&g(!0),!0;const{valid:d,comp:c,err:B}=n[0];return C===u&&(B!==void 0&&console.error(B),g(!1,c),p===!0&&d!==!0&&typeof c.focus=="function"&&c.focus()),!1})}function x(){u++,t.forEach(e=>{typeof e.resetValidation=="function"&&e.resetValidation()})}function h(e){e!==void 0&&F(e);const s=u+1;b().then(p=>{s===u&&p===!0&&(a.onSubmit!==void 0?l("submit",e):e!==void 0&&e.target!==void 0&&typeof e.target.submit=="function"&&e.target.submit())})}function S(e){e!==void 0&&F(e),l("reset"),z(()=>{x(),a.autofocus===!0&&a.noResetFocus!==!0&&v()})}function v(){D(()=>{if(f.value===null)return;const e=f.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(f.value.querySelectorAll("[tabindex]"),s=>s.tabIndex>-1);e!=null&&e.focus({preventScroll:!0})})}A(N,{bindComponent(e){t.push(e)},unbindComponent(e){const s=t.indexOf(e);s>-1&&t.splice(s,1)}});let V=!1;return E(()=>{V=!0}),I(()=>{V===!0&&a.autofocus===!0&&v()}),Q(()=>{a.autofocus===!0&&v()}),Object.assign(o.proxy,{validate:b,resetValidation:x,submit:h,reset:S,focus:v,getValidationComponents:()=>t}),()=>k("form",{class:"q-form",ref:f,onSubmit:h,onReset:S},P(r.default))}});const G={setup(){const a=T(),r=y(null),l=y(null),o=y(!1);return{name:r,age:l,accept:o,onSubmit(){o.value!==!0?a.notify({color:"red-5",textColor:"white",icon:"warning",message:"\u5E33\u865F\u6216\u5BC6\u78BC\u932F\u8AA4"}):a.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"Submitted"})},onReset(){r.value=null,l.value=null,o.value=!1}}}},H={class:"q-pa-md",style:{"max-width":"400px"}};function L(a,r,l,o,f,u){return U(),J("div",H,[m(X,{onSubmit:o.onSubmit,onReset:o.onReset,class:"q-gutter-md"},{default:K(()=>[m(R,{filled:"",modelValue:o.name,"onUpdate:modelValue":r[0]||(r[0]=t=>o.name=t),label:"\u4EBA\u4E8B\u4EE3\u78BC/\u5B78\u751F\u865F\u78BC *","lazy-rules":"",rules:[t=>t&&t.length>0||"\u6B64\u70BA\u907F\u586B"]},null,8,["modelValue","rules"]),m(R,{filled:"",type:"text",modelValue:o.age,"onUpdate:modelValue":r[1]||(r[1]=t=>o.age=t),label:"\u5BC6\u78BC *","lazy-rules":"",rules:[t=>t!==null&&t!==""||"\u6B64\u70BA\u907F\u586B"]},null,8,["modelValue","rules"]),M("div",null,[m(_,{label:"\u767B\u5165",type:"submit",color:"primary"}),m(_,{label:"\u5FD8\u8A18\u5BC6\u78BC",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1},8,["onSubmit","onReset"])])}var Z=O(G,[["render",L]]);export{Z as default};
